<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>App.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">maven</a> &gt; <a href="index.source.html" class="el_package">DodolsCastle</a> &gt; <span class="el_source">App.java</span></div><h1>App.java</h1><pre class="source lang-java linenums">package DodolsCastle;

import java.util.*;

<span class="nc" id="L5">public class App </span>
{
    public static void main( String[] args )
    {
<span class="nc" id="L9">        Scanner input = new Scanner(System.in);</span>
<span class="nc" id="L10">        Boolean testPrinting = false; // allows test print blocks to execute for dev testing</span>
<span class="nc" id="L11">        Dungeon dodolsCastle = new Dungeon();</span>
<span class="nc" id="L12">        dodolsCastle.initializeLayout();</span>
<span class="nc" id="L13">        Hero player = new Hero(dodolsCastle.currentEntrance);</span>
<span class="nc bnc" id="L14" title="All 2 branches missed.">        if(testPrinting)</span>
<span class="nc" id="L15">            dodolsCastle.printDungeon();</span>
<span class="nc" id="L16">        welcomeMessage();</span>
<span class="nc" id="L17">        actionHandler(player, testPrinting, input, false);</span>
<span class="nc" id="L18">        input.close();</span>
        // end game display stuff - credits and whatnot
<span class="nc" id="L20">    }</span>

    public static void welcomeMessage()
    {
        // big work in progress
<span class="fc" id="L25">        System.out.println(&quot;----------+++| Dodol's Castle |+++----------&quot;);</span>
<span class="fc" id="L26">        System.out.println();</span>
        //console.printf(&quot;\n\n&quot;);
<span class="fc" id="L28">        System.out.println(&quot;Welcome to the text-based adventure game, Dodol's Castle!&quot;);</span>
<span class="fc" id="L29">        System.out.println(&quot;Version info and stuff goes here (&gt;'.')&gt;&quot;);</span>
<span class="fc" id="L30">        System.out.println();</span>
<span class="fc" id="L31">        System.out.println();</span>
<span class="fc" id="L32">        System.out.println(&quot;Story intro placeholder -- puts you walking into the common room unexpectedly from your house&quot;);</span>
<span class="fc" id="L33">    }</span>

    public static void formatMessage(String message)
    {
<span class="fc" id="L37">        ArrayList&lt;String&gt; messageArray = new ArrayList&lt;String&gt;();</span>

<span class="fc" id="L39">        int prev = 0;</span>

<span class="fc bfc" id="L41" title="All 2 branches covered.">        for (int i = 0; i &lt; message.length(); i++)</span>
        {
<span class="fc" id="L43">            char x = message.charAt(i);</span>

<span class="fc bfc" id="L45" title="All 2 branches covered.">            if (x == ' ')</span>
            {

<span class="pc bpc" id="L48" title="1 of 4 branches missed.">                if (i - prev &gt;= 90 &amp;&amp; i - prev &lt;= 100)</span>
                {
<span class="fc bfc" id="L50" title="All 2 branches covered.">                    if (prev == 0)</span>
                    {
<span class="fc" id="L52">                        messageArray.add(message.substring(prev, i));</span>
<span class="fc" id="L53">                        prev = i;  </span>
                    }

                    else
                    {
<span class="fc" id="L58">                        messageArray.add(message.substring(prev + 1, i));</span>
<span class="fc" id="L59">                        prev = i;</span>
                    }
                    
                }
            }

<span class="fc bfc" id="L65" title="All 2 branches covered.">            else if (i == message.length() - 1)</span>
            {
<span class="fc bfc" id="L67" title="All 2 branches covered.">                if (prev == 0)</span>
                {
<span class="fc" id="L69">                    messageArray.add(message.substring(prev, i + 1));</span>
<span class="fc" id="L70">                    prev = i;  </span>
                }

                else
                {
<span class="fc" id="L75">                    messageArray.add(message.substring(prev + 1, i + 1));</span>
<span class="fc" id="L76">                    prev = i;</span>
                }
            }
        }

<span class="pc bpc" id="L81" title="1 of 2 branches missed.">        if (messageArray.size() == 0)</span>
        {
<span class="nc" id="L83">            messageArray.add(message.substring(0, message.length()));</span>
        }

<span class="fc bfc" id="L86" title="All 2 branches covered.">        for (String x : messageArray)</span>
        {
<span class="fc" id="L88">            System.out.println(x);</span>
<span class="fc" id="L89">        }</span>
        //console.printf(&quot;\n&quot;);
<span class="fc" id="L91">    }</span>

    public static void actionHandler(Hero player, Boolean testPrinting, Scanner input, Boolean appTest)
    {
        // print room name &amp; description        
<span class="fc" id="L96">        formatMessage(&quot;\n\n&quot; + &quot;+ &quot; + player.currentRoom.name + &quot; +&quot;);</span>
<span class="fc" id="L97">        formatMessage(player.currentRoom.description + &quot;\n&quot;);</span>

        // get available actions from player.actions &amp; player.currentRoom.actions
<span class="fc" id="L100">        ArrayList&lt;Action&gt; availableActions = getAvailableActions(player.currentRoom, player, testPrinting);</span>

        // player input &amp; action selection logic
<span class="fc" id="L103">        System.out.println(&quot;--------------------------------------------------\n&quot;);</span>
        
<span class="fc" id="L105">        Boolean invalid = true;</span>
<span class="fc" id="L106">        Boolean gameOver = false;</span>
<span class="fc bfc" id="L107" title="All 2 branches covered.">        while(invalid)</span>
        {
<span class="fc" id="L109">            System.out.println(&quot;Enter a command:&quot;);</span>
<span class="fc" id="L110">            String in = input.nextLine();</span>
<span class="fc" id="L111">            System.out.print(String.format(&quot;\033[2J&quot;));</span>
<span class="fc" id="L112">            System.out.println();</span>
            // movement handling
<span class="pc bpc" id="L114" title="1 of 4 branches missed.">            if(in.contains(&quot;north&quot;) &amp;&amp; player.currentRoom.doors[0] != null)</span>
            {
<span class="fc" id="L116">                String effect = &quot;north&quot;;</span>
<span class="fc" id="L117">                System.out.println(&quot;You moved north.&quot;);</span>
<span class="fc" id="L118">                player.addHistory(&quot;You moved north&quot;, effect);</span>
<span class="fc" id="L119">                player.currentRoom = player.currentRoom.doors[0];</span>
<span class="fc" id="L120">                invalid = false;</span>
<span class="fc" id="L121">            }</span>
<span class="pc bpc" id="L122" title="1 of 4 branches missed.">            else if(in.contains(&quot;east&quot;) &amp;&amp; player.currentRoom.doors[1] != null)</span>
            {
<span class="fc" id="L124">                String effect = &quot;east&quot;;</span>
<span class="fc" id="L125">                System.out.println(&quot;You moved east.&quot;);</span>
<span class="fc" id="L126">                player.addHistory(&quot;You moved east&quot;, effect);</span>
<span class="fc" id="L127">                player.currentRoom = player.currentRoom.doors[1];</span>
<span class="fc" id="L128">                invalid = false;</span>
<span class="fc" id="L129">            }</span>
<span class="pc bpc" id="L130" title="1 of 4 branches missed.">            else if(in.contains(&quot;south&quot;) &amp;&amp; player.currentRoom.doors[2] != null)</span>
            {
<span class="fc" id="L132">                String effect = &quot;south&quot;;</span>
<span class="fc" id="L133">                System.out.println(&quot;You moved south.&quot;);</span>
<span class="fc" id="L134">                player.addHistory(&quot;You moved south&quot;, effect);</span>
<span class="fc" id="L135">                player.currentRoom = player.currentRoom.doors[2];</span>
<span class="fc" id="L136">                invalid = false;</span>
<span class="fc" id="L137">            }</span>
<span class="pc bpc" id="L138" title="1 of 4 branches missed.">            else if(in.contains(&quot;west&quot;) &amp;&amp; player.currentRoom.doors[3] != null)</span>
            {
<span class="fc" id="L140">                String effect = &quot;west&quot;;</span>
<span class="fc" id="L141">                System.out.println(&quot;You moved west.&quot;);</span>
<span class="fc" id="L142">                player.addHistory(&quot;You moved west&quot;, effect);</span>
<span class="fc" id="L143">                player.currentRoom = player.currentRoom.doors[3];</span>
<span class="fc" id="L144">                invalid = false;</span>
<span class="fc" id="L145">            }</span>
            // show hero status (health description)
<span class="fc bfc" id="L147" title="All 2 branches covered.">            else if(in.contains(&quot;status&quot;))</span>
            {
<span class="fc" id="L149">                formatMessage(player.getStatusDescription(testPrinting));</span>
<span class="fc" id="L150">                invalid = false;</span>
            }
            // show hero log (past actions, rooms)
<span class="fc bfc" id="L153" title="All 2 branches covered.">            else if(in.contains(&quot;log&quot;))</span>
            {
<span class="fc" id="L155">                player.printHistory();</span>
<span class="fc" id="L156">                invalid = false;</span>
            }
            // displays helpful info and available actions
<span class="fc bfc" id="L159" title="All 2 branches covered.">            else if(in.contains(&quot;help&quot;))</span>
            {
<span class="fc" id="L161">                printHelpInfo(availableActions);</span>
<span class="fc" id="L162">                invalid = false;</span>
            }
            // show inventory (player.items)
<span class="fc bfc" id="L165" title="All 2 branches covered.">            else if (in.contains(&quot;inventory&quot;))</span>
            {
<span class="fc" id="L167">                player.printInventory();</span>
<span class="fc" id="L168">                invalid = false;</span>
            }
            // toggle developer test printing
<span class="pc bpc" id="L171" title="1 of 2 branches missed.">            else if (in.contains(&quot;dev&quot;))</span>
            {
<span class="nc" id="L173">                System.out.println(&quot;[Dev] Toggling test printing...\n&quot;);          </span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">                if(testPrinting) testPrinting = false;</span>
<span class="nc" id="L175">                else testPrinting = true;</span>
<span class="nc" id="L176">                System.out.println(&quot;[Dev] &gt; Test Printing = &quot; + testPrinting);</span>
<span class="nc" id="L177">                invalid = false;</span>
            }
            // check input against available actions
<span class="pc bpc" id="L180" title="1 of 2 branches missed.">            else if(invalid)</span>
            {
<span class="fc bfc" id="L182" title="All 2 branches covered.">                for(Action action : availableActions)</span>
                {
<span class="fc bfc" id="L184" title="All 2 branches covered.">                    if(in.contains(action.name))</span>
                    {
<span class="fc" id="L186">                        formatMessage(action.description);</span>
<span class="fc" id="L187">                        action.runAction(player);</span>
<span class="fc" id="L188">                        invalid = false;</span>
<span class="pc bpc" id="L189" title="1 of 2 branches missed.">                        if(in.contains(&quot;go home&quot;))</span>
                        {
<span class="nc" id="L191">                            System.out.println();</span>
<span class="nc" id="L192">                            gameOver = true;</span>
                        }
                    }                
<span class="fc" id="L195">                }</span>
            }         
            // check items for examiniation -- dead code now but might be used later
            /* else if(in.contains(&quot;examine&quot;))
            {
                String thing = in.substring(8, in.length() - 1);
                if(!player.currentRoom.items.isEmpty())
                for (Item i : player.currentRoom.items)
                {
                    if(i.name.contains(thing))
                    {
                        if(console != null)
                        {
                            formatMessage(&quot;\nYou examine the &quot; + i.name + &quot;:&quot;, console);
                            formatMessage(i.description, console);
                        }  
                        invalid = false;                         
                    }
                }
                if(!player.items.isEmpty())
                for (Item i : player.items)
                {
                    if(i.name.contains(thing))
                    {
                        if(console != null)
                        {
                            formatMessage(&quot;\nYou examine the &quot; + i.name + &quot;:&quot;, console);
                            formatMessage(i.description, console);                        
                        }
                        invalid = false;                           
                    }
                }
            } */
            // check items for taking
            /* else if(in.contains(&quot;take&quot;))
            {
                String thing = in.substring(5, in.length() - 1);
                ArrayList&lt;Item&gt; temp = new ArrayList&lt;Item&gt;();
                for (Item i : player.currentRoom.items)
                {
                    temp.add(i);
                    if(i.name.contains(thing) &amp;&amp; i.canTake)
                    {
                        player.items.add(i);
                        temp.remove(i);
                        if(!i.heroActionsAdd.isEmpty())
                        {
                            for(Action a : i.heroActionsAdd)
                            {
                                player.actions.add(a);
                            }
                        }
                        if(console != null)
                        {
                            formatMessage(&quot;\nYou take the &quot; + i.name + &quot;.&quot;, console);
                        }
                        invalid = false;                 
                    }
                }
                player.currentRoom.items = temp;
            }   */        
<span class="fc bfc" id="L256" title="All 2 branches covered.">            if(invalid)</span>
            {
<span class="pc bpc" id="L258" title="1 of 2 branches missed.">                if (appTest != true)</span>
                {
<span class="nc" id="L260">                    System.out.println(&quot;Please enter a valid action, type 'help' for more info\n&quot;);    </span>
                }
                
                else
                {
<span class="fc" id="L265">                    System.out.println(&quot;Please enter a valid action, type 'help' for more info\n&quot;);</span>
<span class="fc" id="L266">                    break;</span>
                }
            }
<span class="fc" id="L269">        }</span>
<span class="pc bpc" id="L270" title="2 of 4 branches missed.">        if(player.status &gt; 0 &amp;&amp; !gameOver)</span>
        {
<span class="pc bpc" id="L272" title="1 of 2 branches missed.">            if (appTest != true)</span>
            {
<span class="nc" id="L274">                actionHandler(player, testPrinting, input, false);    </span>
            }    
        }
        else
        {
<span class="nc" id="L279">            System.out.println(&quot;+++| Game Over |+++&quot;);</span>
        } 
<span class="fc" id="L281">    }</span>

    public static ArrayList&lt;Action&gt; getAvailableActions(Room curRoom, Hero player, Boolean testPrinting)
    {
<span class="pc bpc" id="L285" title="1 of 2 branches missed.">        if(testPrinting)</span>
<span class="nc" id="L286">            System.out.println(&quot;[Dev] Gathering available actions...\n&quot;);</span>
<span class="fc" id="L287">        ArrayList&lt;Action&gt; availableActions = new ArrayList&lt;Action&gt;();</span>
<span class="fc" id="L288">        ArrayList&lt;Action&gt; prunedList = new ArrayList&lt;Action&gt;();</span>
<span class="pc bpc" id="L289" title="1 of 2 branches missed.">        if(!player.actions.isEmpty())</span>
        {
<span class="fc" id="L291">            availableActions.addAll(player.actions);</span>
<span class="pc bpc" id="L292" title="1 of 2 branches missed.">            if(testPrinting)</span>
            {
<span class="nc" id="L294">                System.out.println(&quot;[Dev] &gt; Found actions in hero: \n&quot;);</span>
<span class="nc bnc" id="L295" title="All 2 branches missed.">                for (Action action : player.actions) </span>
                {
<span class="nc" id="L297">                    System.out.println(&quot;\t- &quot; + action.name + &quot;\n&quot;);</span>
<span class="nc" id="L298">                }</span>
            }       
        }
<span class="fc bfc" id="L301" title="All 2 branches covered.">        if(!player.currentRoom.actions.isEmpty())</span>
        {
<span class="fc" id="L303">            availableActions.addAll(player.currentRoom.actions);</span>
<span class="pc bpc" id="L304" title="1 of 2 branches missed.">            if(testPrinting)</span>
            {
<span class="nc" id="L306">                System.out.println(&quot;[Dev] &gt; Found actions in room: \n&quot;);</span>
<span class="nc bnc" id="L307" title="All 2 branches missed.">                for (Action action : player.currentRoom.actions) </span>
                {
<span class="nc" id="L309">                    System.out.println(&quot;\t- &quot; + action.name + &quot;\n&quot;);</span>
<span class="nc" id="L310">                }</span>
            }
        }
<span class="pc bpc" id="L313" title="1 of 2 branches missed.">        if(testPrinting)</span>
<span class="nc" id="L314">            System.out.println(&quot;[Dev] Checking action requirements...\n&quot;);     </span>
<span class="pc bpc" id="L315" title="1 of 2 branches missed.">        if(!availableActions.isEmpty())</span>
        {
<span class="fc bfc" id="L317" title="All 2 branches covered.">            for(Action action : availableActions)</span>
            {
<span class="pc bpc" id="L319" title="1 of 2 branches missed.">                if(testPrinting)</span>
<span class="nc" id="L320">                    System.out.println(&quot;[Dev] &gt; Checking: &quot; + action.name + &quot;\n&quot;);</span>
<span class="fc" id="L321">                Boolean needsMet = false;</span>
<span class="fc" id="L322">                Boolean restraintPresent = false;</span>

<span class="fc bfc" id="L324" title="All 2 branches covered.">                for(Action checkAction : availableActions)</span>
                {
<span class="fc bfc" id="L326" title="All 2 branches covered.">                    if(action.requirementsPos.isEmpty())</span>
                    {
<span class="fc" id="L328">                        needsMet = true;</span>
                    }
                    else
                    {
<span class="fc bfc" id="L332" title="All 2 branches covered.">                        for(Action posReq : action.requirementsPos)</span>
                        {
<span class="pc bpc" id="L334" title="1 of 2 branches missed.">                            if(checkAction == posReq)</span>
                            {
<span class="nc" id="L336">                                needsMet = true; // doesnt account for more than one need right now</span>
                            }
<span class="fc" id="L338">                        }</span>
                    }
<span class="pc bpc" id="L340" title="1 of 2 branches missed.">                    for(Action negReq : action.requirementsNeg)</span>
                    {
<span class="nc bnc" id="L342" title="All 2 branches missed.">                        if(checkAction == negReq)</span>
                        {
<span class="nc" id="L344">                            restraintPresent = true;</span>
                        }
<span class="nc" id="L346">                    }</span>
<span class="fc" id="L347">                }</span>

<span class="pc bpc" id="L349" title="1 of 4 branches missed.">                if(!needsMet || restraintPresent)</span>
			    {
                    //availableActions.remove(action);
<span class="pc bpc" id="L352" title="1 of 2 branches missed.">                    if(testPrinting)</span>
<span class="nc" id="L353">                        System.out.println(&quot;[Dev] &gt;&gt; Pruned &quot; + &quot;\n&quot;);</span>
                }
                else
                {
<span class="fc" id="L357">                    prunedList.add(action);</span>
<span class="pc bpc" id="L358" title="1 of 2 branches missed.">                    if(testPrinting)</span>
<span class="nc" id="L359">                        System.out.println(&quot;[Dev] &gt;&gt; Accepted &quot; + &quot;\n&quot;);</span>
                }
<span class="fc" id="L361">		    }</span>
        }
<span class="fc" id="L363">        availableActions = prunedList;</span>
<span class="fc" id="L364">        return availableActions;</span>
    }

    public static void printHelpInfo(ArrayList&lt;Action&gt; availableActions)
    {
<span class="fc" id="L369">        formatMessage(&quot;Insert useful help info here, common action keywords and stuff&quot;);</span>
<span class="fc" id="L370">        formatMessage(&quot;Listing actions available to you:&quot;);</span>
<span class="fc bfc" id="L371" title="All 2 branches covered.">        for(Action a : availableActions)</span>
        {
<span class="fc" id="L373">            System.out.println(&quot;\t- &quot; + a.name + &quot;\n&quot;);</span>
<span class="fc" id="L374">        }</span>
        // print available actions
<span class="fc" id="L376">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>